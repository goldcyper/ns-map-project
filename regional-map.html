<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Interactive SVG Map</title>
    <meta name="description" content="Regional Map">
    <meta name="author" content="Map Maker">
    <style>
        /* SVG File CSS */
        /* Edit background-color: white; to hex background color of your choice for map */

        svg {
            width: 100%;
            height: auto;
            background-color: white;
        }

        /* Label CSS */
        /* Edit color:black; to hex color of your choice for label text */

        .label {
            width: 100%;
            height: auto;
            color: black;
        }
    </style>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Change this google spreadsheet file url to your own as this is blank:
            fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRPtAGyGL_ESY8Q0Sc5b_dcwIX48bqtNoftmTsVAgO3RyEDqundo8NltWylMz3gL0dEeMfPiXWrfPtL/pubhtml')
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const rows = doc.querySelectorAll("table tbody tr");
                    const svg = document.querySelector("svg");
                    rows.forEach((row, index) => {
                        if (index === 0) return; // Skip header row
                        const cells = row.querySelectorAll("td");
                        if (cells.length < 7) {
                            console.error(`Row ${index + 1} does not have enough data:`, row);
                            return;
                        }
                        const label = cells[0].innerHTML;
                        const url = cells[1].innerText;
                        const fillColor = cells[2].innerText;
                        const labelPosition = cells[3].innerText; // Added custom label position
                        const strokeColor = cells[4].innerText;
                        const strokeWidth = cells[5].innerText;
                        const pathData = cells[6].innerText;
                        console.log(`Processing row ${index + 1}:`, { label, url, fillColor, strokeColor, strokeWidth, pathData });
                        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                        const link = document.createElementNS("http://www.w3.org/2000/svg", "a");
                        path.setAttribute("d", pathData);
                        path.setAttribute("fill", fillColor);
                        path.setAttribute("stroke", strokeColor);
                        path.setAttribute("stroke-width", strokeWidth);
                        link.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", url);
                        link.setAttributeNS("http://www.w3.org/1999/xlink", "target", "_blank");
                        link.appendChild(path);
                        svg.appendChild(link);

                        // Calculate label position within object bounds
                        const bbox = path.getBBox();
                        let [labelX, labelY] = labelPosition.split(',').map(Number);
                        if (isNaN(labelX) || isNaN(labelY)) {
                            labelX = bbox.x + bbox.width / 2;
                            labelY = bbox.y + bbox.height / 2;
                        } else {
                            labelX = Math.max(bbox.x, Math.min(bbox.x + bbox.width, bbox.x + labelX));
                            labelY = Math.max(bbox.y, Math.min(bbox.y + bbox.height, bbox.y + labelY));
                        }

                        text.setAttribute("x", labelX);
                        text.setAttribute("y", labelY);
                        text.setAttribute("fill", "black");
                        text.setAttribute("text-anchor", "middle");
                        text.setAttribute("dominant-baseline", "middle");
                        text.setAttribute("class", "label"); // Assign CSS class to text
                        text.innerHTML = label;
                        svg.appendChild(text);
                        console.log(`Added path and label for ${label}`);
                    });
                    console.log('All rows processed');
                })
                .catch(error => {
                    console.error('Error loading HTML:', error);
                });
        });
    </script>
</head>
<body>
    <svg width="100%" height="100%" viewBox="0 0 2000 1015" xmlns="http://www.w3.org/2000/svg"></svg>
</body>
</html>
